# README

This is a quick documentation for my solution

pre-requests:-
==============
1- docker installed
2- docker composer installed
3- web browser (safari, chrome, firefox,...)
4- any prefered editor (sublime, atom,...)

steps:-
=======
1- clone the repo
git clone git@github.com:hebatarekobjects/taskinstabug.git

2- change directory for the clonning directory "taskinstabug"

3- run the following command:-
 docker-compose up (for the logs in the console)
 docker-compose up -d (for deamon running)

 3- run the following command to execute the migration
  docker-compose run app rake db:migrate

4- open any prefered browser and go to 
    http://localhost:3001/api-doc/index.html
    this is the link for swagger documentation, you can use it to test the api
    or you can use postman if you prefer it

description for my solution
============================

- All APIs consume and produce application/json
- active record job is used for queuing messages and chats (creation and delete)
- elastic search is used for searching for message
- application API
    1- /application -> to get all applications in the system, with pagination
        method: get
        query parameter :-
        page : it's the page number (required)
        response will be sorted descening (creation time)
    2- /application -> to create new application
        method : post
        parameters :-
            {
                client_name: "any client_name"
            }
            client name is unique
    3- /application/{token} -> to get or show single application by its token (generated by the system (uuid))
        method : get

    4- /application/{token} -> to get or delete single application by its token (generated by the system (uuid))
        method : delete
        when application is deleted, chats under it and messages will not be deleted also 
        i make assumption as whatsapp , when someone delete his account or block me, his chat with me still exist and not deleted

- chat API
    1- /chat -> to get all chats in the system for a specific application, with pagination
        method: get
        query parameter :-
        page : it's the page number (required)
        application_token: it's application uuid token (required)
        response will be sorted descening (creation time)
    2- /chat -> to create new application
        method : post
        parameters :-
            {
               "sender_token": "this is sender application token",
                "receiver_token": "this is receiver application token"
            }

    3- /chat/{token} -> to get or show single chat by its token (generated by the system (uuid))
        method : get

    4- /chat/{token} -> to get or delete single chat by its token (generated by the system (uuid))
        method : delete
        when chat is deleted for any reason, messages under it will be deleted also
        and will affect the count of chats for sender and receiver applications

- message API
    1- /message -> to get all messages in the system for a specific chat, with pagination
        method: get
        query parameter :-
        page : it's the page number (required)
        chat_token: it's application uuid token (required)
        response will be sorted descening (creation time)
        search_query: this is the query that will be used for search (elastic search), (optional)
    2- /message -> to create new application
        method : post
        parameters :-
            {
               "body": "body of the message",
                "sender_token": "application sender token",
                "receiver_token": "application receiver token",
                "chat_token": "chat token"
            }

    3- /message/{token} -> to get or show single message by its token (generated by the system (uuid))
        method : get

    4- /message/{token} -> to get or delete single message by its token (generated by the system (uuid))
        method : delete
        will affect the count of messages for the it's chat



